# Product Overview - Oshi-Trainer

**Inclusion Mode**: Always

## Product Description

Oshi-Trainerは、ユーザーが「推し」（お気に入りのアイドル、キャラクター、タレントなど）との関係を深めながらモチベーションを維持できるトレーニングアプリケーションです。

### コンセプト
単調な筋トレを、推し（AI）と行うことで、楽しく、自分の限界を越えることができ、継続できるアプリ

## Background & Problem Statement

### 課題の背景
- **日本人の座位時間は世界1位**: 長時間の座位は健康問題に直結
- **運動不足の深刻化**: 特にゲーム・アニメファンの約7割が運動をしていない
- **潜在ニーズの存在**: 全体の4割は運動をしようとしているができていない

### ギャップ分析
多くのゲーム・アニメファンが「運動が嫌い」なのではなく、**「趣味と両立できる最適な解決策がない」**という潜在ニーズが存在します。Oshi-Trainerは、このギャップを埋め、趣味と健康を両立させることを目指します。

## Core Features

現在のプロジェクトは初期段階にあり、以下の機能の実装が想定されています：

### 【機能1】AIコンパニオン・システム（Priority: High）
- **リアルタイム・フォームアシスト**（Future Feature）:
  - スマートフォンのカメラを用いた姿勢推定技術により、オーバーヘッドプレスやスクワットなどのフォームをリアルタイムで解析
  - AIコンパニオンが「もっと腰を落として！」「背中が丸まってるぞ！」など的確に指導・応援

- **デフォルト推しトレーナー**（✅ 実装済み）:
  - デフォルトトレーナー「推乃 愛（オシノ アイ）」の実装
  - ツンデレ性格（五等分の花嫁の二乃のような性格）
  - 一人称「うち」、二人称「あんた」を使用
  - テンプレートセリフによるキャラクター表現
  - 将来的なLLM統合の基盤を提供

- **推しトレーナーテンプレートシステム**（✅ 実装済み）:
  - テンプレート化された推しトレーナーの入力項目を整理
  - `OshiTrainerTemplate`: 基本プロフィール、性格パラメータ、LLM統合パラメータ、音声・トレーニング設定を統合
  - `PersonalityType`: 5種類の性格タイプ（優しい、元気、クール、ツンデレ、厳しい）
  - `EncouragementStyle`: 応援スタイル（熱血、冷静、自然、過保護）
  - `FeedbackFrequency`: フィードバック頻度（最小限、適度、頻繁、常時）
  - 将来の推し作成機能の基盤を提供

- **推しトレーナー作成**（Future Feature）:
  - ユーザーは自分の好みの顔、性格、声のトレーナーを作成可能
  - テンプレートシステムに基づいたパラメータ入力
  - LLM（大規模言語モデル）を活用し、性格に応じた多様なセリフでユーザーを鼓舞

### 【機能2】統計システム（Future Feature）
- **統計**: トレーニングの統計を表示する機能
- **レベルとステータス**:
  - トレーニング完了でEXPが溜まり、推しレベルが上昇
  - 将来的にランキング機能を搭載し、トレーニング量が推しのランキングに反映

### 【機能3】通知機能（Future Feature）
- **推しからのトレーニングのお誘い**:
  - Googleカレンダーと連携し、ユーザーの予定を把握
  - 的確なタイミングでトレーニングのお誘いを送信
  - まるでLINEで推しから連絡が来るような体験

## Target Use Case

### Primary Users
- ゲーム・アニメファンで、健康的なライフスタイルを目指す人
- トレーニングを継続するためのモチベーションを必要としている人
- 推し活とフィットネスを結びつけたい人

### ペルソナ
- **名前**: ユウキ
- **年齢**: 20代半ば
- **職業**: ITエンジニア / ゲーマー
- **悩み**:
  - 平日はデスクワーク、休日はゲーム三昧で、慢性的な運動不足と体の不調を感じている
  - ジムは「陽キャ」の集まりに感じてしまい、一人での筋トレは3日坊主で終わる
  - モチベーションの源泉が、ゲームのレベル上げや好きなキャラクター（推し）からの承認である

### Key Scenarios
1. **日常的なトレーニング**: 推しAIからのリアルタイムフィードバックと応援を受けながらトレーニングを実施
2. **目標達成とレベルアップ**: トレーニング目標を設定し、推しと一緒に達成を目指し、推しレベルを上げる
3. **記録管理と統計**: トレーニング履歴を記録し、統計データで成長を実感する
4. **最適なタイミングでの通知**: カレンダー連携により、忙しい日常の中でも適切なタイミングでトレーニングを促進

## Key Value Proposition

- **推しの力でモチベーション向上**: 好きなキャラクターやアイドルと一緒にトレーニングすることで、継続しやすい環境を提供
- **楽しいトレーニング体験**: 単調になりがちなトレーニングを、推し活として楽しい活動に変換
- **パーソナライズされた体験**: ユーザーの推しに合わせたカスタマイズ可能な体験
- **iOS ネイティブ体験**: SwiftUIによる滑らかで直感的なインターフェース

## Development Stage

### Current Implementation Status

プロジェクトは基本的なUI実装フェーズが完了し、以下の機能が実装済みです：

#### ✅ 実装済み機能
- **ホーム画面（ウマ娘風UI）**:
  - 推しキャラクターの表示（背景透過PNG、無限ループアニメーション対応）
  - 推しレベルとEXP表示
  - セリフ表示機能（吹き出し付き）
  - ナビゲーションボタン（統計、設定）
  - 推し作成ボタン（カスタム画像アセット: `oshi_create.png`）
  - キャラクタータップによる詳細画面表示

- **デフォルト推しトレーナー「推乃 愛（オシノ アイ）」**:
  - ツンデレ性格のデフォルトトレーナー
  - 一人称「うち」、二人称「あんた」を使用
  - テンプレートセリフシステム（挨拶、トレーニング開始、応援、照れ隠し）
  - キャラクター画像の背景透過とアルファヒットテスト
  - ホーム画面への統合表示

- **トレーナー詳細画面**:
  - トレーナーの詳細情報表示（名前、イメージカラー、一人称、呼び方、性格、ボイス）
  - キャラクターアイコン表示（円形クリッピング、テーマカラーボーダー）
  - カスタムスケール・オフセット対応（`detailIconScale`, `detailIconOffsetY`）

- **レベル詳細画面**:
  - レベルとEXPの詳細表示
  - 実績（アチーブメント）表示

- **統計画面**:
  - 月別統計表示
  - カテゴリ別統計表示

- **設定画面**: 基本的な設定画面UI

- **推しトレーナー作成画面**: 作成画面への導線

- **トレーニングポップアップ**: トレーニング開始のためのUI

- **データモデルとサービス層**:
  - `OshiTrainer`, `Achievement`, `Statistics`, `TrainingSession`モデル
  - `DefaultOshiTrainerData`: デフォルトトレーナーのデータ定義
  - `OshiTrainerTemplate`: 推しトレーナーテンプレートモデル（詳細画面表示用パラメータ含む: `detailIconScale`, `detailIconOffsetY`）
  - `PersonalityType`, `EncouragementStyle`, `FeedbackFrequency`: 性格・トレーニングパラメータモデル
  - プロトコル指向の`DataServiceProtocol`
  - 開発用`MockDataService`
  - `DialogueTemplateProvider`: テンプレートセリフ提供サービス
  - `AudioFeedbackService`: ずんだもん音声フィードバックサービス（AVAudioPlayerキュー式再生）

- **カスタムUIコンポーネント**:
  - ウマ娘風カラーパレット（`Color+Oshi`）
  - カスタムボタンスタイル（`OshiButtonStyle`）
  - カスタムテキストスタイル（`OshiTextStyles`）
  - `TransparentImageView`: 背景透過画像表示
  - `AlphaHitTestImageView`: アルファ値ベースのタップ判定

#### 🧪 実験中のプロトタイプ
- **Pythonベースの姿勢推定プロトタイプ**:
  - **技術スタック**:
    - YOLOv11 Poseモデル（`yolo11n-pose.pt`）を使用したリアルタイム姿勢推定
    - OpenCV + Ultralytics
    - ルールベースフォーム解析エンジン
    - レップカウント機能
    - 速度判定（早すぎる/遅すぎる）
    - pygame音声フィードバックシステム
  - **オーバーヘッドプレス解析**（`main_overheadpress.py`）:
    - 肘の開きエラー検出（肩幅正規化）
    - ずんだもん音声フィードバック（48音声ファイル）
    - 角度ベースのレップカウント
  - **Core ML変換ユーティリティ**（`convert_models.py`）:
    - YOLOモデルのCore ML形式への変換スクリプト
    - iOS統合のための準備ツール
  - 注: 現在はスタンドアロンPythonスクリプト、iOS統合は今後の課題

#### 🔄 次のフェーズ
- **リアルタイムフォーム解析機能**: Pythonプロトタイプベースの姿勢解析をiOSに統合（計画中）
- **Core MLモデル変換**: YOLOモデルのCore ML形式への変換
- **経験値とレベルアップシステム**: トレーニング完了時のEXP付与
- **通知機能**: カレンダー連携とプッシュ通知
- **LLM統合**: 推しのパーソナリティ生成と動的セリフ生成
